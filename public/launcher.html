async function sendBulkEmails() {
  const yourEmail = localStorage.getItem("yourEmail");
  const appPassword = localStorage.getItem("appPassword");

  const senderName = document.getElementById("senderName").value;
  const subject = document.getElementById("subject").value;
  const messageBody = document.getElementById("message").value;
  const emails = document.getElementById("emails").value
    .split("\n")
    .map((e) => e.trim())
    .filter((e) => e);

  if (!yourEmail || !appPassword) {
    alert("❌ Not logged in");
    window.location.href = "login.html";
    return;
  }

  const res = await fetch("/send-bulk", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ senderName, yourEmail, appPassword, subject, messageBody, emails }),
  });

  const data = await res.json();
  if (data.ok) alert(`✅ ${data.count} emails sent successfully!`);
  else alert(`❌ Failed: ${data.error}`);
}
